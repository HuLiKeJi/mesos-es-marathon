[supervisord]
logfile=/dev/null
pidfile=/var/run/supervisord.pid
nodaemon=true

[program:add_es_confd_template]
command=add-confd-config.py
user=elasticsearch
auto_start=true
startsecs=0
autorestart=false

[program:es_zk_disco_sync]
command=es-zk-disco-sync.py
redirect_stderr=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
user=elasticsearch
auto_start=true
autorestart=true

[program:chmod_volumes]
command=bash -c 'sleep 3 && chmod -R 777 /es-data && chmod -R 777 /mnt/mesos/sandbox'
auto_start=true
startsecs=0
autorestart=false

[program:confd]
command=bash -c 'sleep 5 && confd -config-file /etc/confd/confd.toml'
user=elasticsearch
redirect_stderr=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
auto_start=true
autorestart=true

[program:elasticsearch]
command=bash -c 'sleep 10 && /opt/elasticsearch/bin/elasticsearch -Epath.conf=/mnt/mesos/sandbox/config/'
user=elasticsearch
redirect_stderr=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
auto_start=true
autorestart=true